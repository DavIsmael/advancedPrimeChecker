REALLY MESSY CODE I KNOW

BUT IF IT WORKS IT WORKS AMIRIGHT XD
